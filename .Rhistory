#Norm funcs
nrmw.stk=function(x,y) {
tmp1=to.weekly(x)
names(tmp1)=c("op", "hi", "lo", "cl", "vo", "ad")
tmp2=last(tmp1,y)
tmp1=tmp2$cl/max(tmp2$hi)
return(tmp1)
}
nrmw.com=function(x,y){
tmp1=to.weekly(x)
names(tmp1)=c("op", "hi", "lo", "cl")
tmp2=last(tmp1,y)
tmp1=tmp2$cl/max(tmp2$hi)
return(tmp1)
}
#Download Data
# install quantmod
#install.packages('quantmod')
library(quantmod)
getSymbols("XAU/USD", src="oanda")
getSymbols("XAG/USD", src="oanda")
getSymbols("XPT/USD", src="oanda")
getSymbols("XCU/USD", src="oanda")
getSymbols("EUR/USD",src="oanda")
getSymbols("INR/USD",src="oanda")
getSymbols("CNY/USD",src="oanda")
getSymbols("JPY/USD",src="oanda")
getSymbols("BRL/USD",src="oanda")
getSymbols("RUB/USD", src="oanda")
getSymbols("^GSPC", src = "yahoo")
gldnw=nrmw.com(XAUUSD,0)
slvnw=nrmw.com(XAGUSD,0)
pltnw=nrmw.com(XPTUSD,0)
eurnw=nrmw.com(EURUSD,0)
inrnw=nrmw.com(INRUSD,0)
cnynw=nrmw.com(CNYUSD,0)
brlnw=nrmw.com(BRLUSD,0)
rubnw=nrmw.com(RUBUSD,0)
spxnw=nrmw.stk(GSPC,length(gldnw))
leg=c("au","ag","pt","eur","inr","cny","brl","rub","sp500")
limy=c(0.45,1.1)
plot(gldnw,ylim=limy)
lines(slvnw,col=2)
lines(pltnw,col=3)
lines(eurnw,col=4)
lines(inrnw,col=5)
lines(cnynw,col=6)
lines(brlnw,col=7)
lines(rubnw,col=8)
lines(spxnw,col=9,lty=5,lwd=2)
legend("topleft",leg,text.col=c(1:9),horiz=TRUE)
?fft
install.packages('tm')
?stl
plot(fft(spxnw))
head(spxnw)
head(GSPC)
plot(fft(GSPC$GSPC.Close))
plot(diff(GSPC$GSPC.Close))
?diff
plot(diff(spxnw))
plot(stl(diff(spxnw)))
decompose(spxnw)
plot(stl(diff(GSPC$GSPC.Close)))
plot((diff(GSPC$GSPC.Close)))
plot((diff(to.weekly(GSPC$GSPC.Close))))
plot((diff(diff(to.weekly(GSPC$GSPC.Close)))))
plot((diff(to.monthly(GSPC$GSPC.Close))))
plot(diff(spxnw))
?splinefun
plot(splinefun(spxnw))
plot(splinefun(spxnw$cl))
?bs
library9graphics
library(graphics)
?bs
library(stats)
?bs
install.packages('highfrequency')
install.packages('stockPortfolio')
#Norm funcs
nrmw.stk=function(x,y) {
tmp1=to.weekly(x)
names(tmp1)=c("op", "hi", "lo", "cl", "vo", "ad")
tmp2=last(tmp1,y)
tmp1=tmp2$cl/max(tmp2$hi)
return(tmp1)
}
nrmw.com=function(x,y){
tmp1=to.weekly(x)
names(tmp1)=c("op", "hi", "lo", "cl")
tmp2=last(tmp1,y)
tmp1=tmp2$cl/max(tmp2$hi)
return(tmp1)
}
#Download Data
# install quantmod
#install.packages('quantmod')
library(quantmod)
getSymbols("XAU/USD", src="oanda")
getSymbols("XAG/USD", src="oanda")
getSymbols("XPT/USD", src="oanda")
getSymbols("XCU/USD", src="oanda")
getSymbols("EUR/USD",src="oanda")
getSymbols("INR/USD",src="oanda")
getSymbols("CNY/USD",src="oanda")
getSymbols("JPY/USD",src="oanda")
getSymbols("BRL/USD",src="oanda")
getSymbols("RUB/USD", src="oanda")
getSymbols("^GSPC", src = "yahoo")
gldnw=nrmw.com(XAUUSD,0)
slvnw=nrmw.com(XAGUSD,0)
pltnw=nrmw.com(XPTUSD,0)
eurnw=nrmw.com(EURUSD,0)
inrnw=nrmw.com(INRUSD,0)
cnynw=nrmw.com(CNYUSD,0)
brlnw=nrmw.com(BRLUSD,0)
rubnw=nrmw.com(RUBUSD,0)
spxnw=nrmw.stk(GSPC,length(gldnw))
leg=c("au","ag","pt","eur","inr","cny","brl","rub","sp500")
limy=c(0.45,1.1)
plot(gldnw,ylim=limy)
lines(slvnw,col=2)
lines(pltnw,col=3)
lines(eurnw,col=4)
lines(inrnw,col=5)
lines(cnynw,col=6)
lines(brlnw,col=7)
lines(rubnw,col=8)
lines(spxnw,col=9,lty=5,lwd=2)
legend("topleft",leg,text.col=c(1:9),horiz=TRUE)
#Norm funcs
nrmw.stk=function(x,y) {
tmp1=to.weekly(x)
names(tmp1)=c("op", "hi", "lo", "cl", "vo", "ad")
tmp2=last(tmp1,y)
tmp1=tmp2$cl/max(tmp2$hi)
return(tmp1)
}
nrmw.com=function(x,y){
tmp1=to.weekly(x)
names(tmp1)=c("op", "hi", "lo", "cl")
tmp2=last(tmp1,y)
tmp1=tmp2$cl/max(tmp2$hi)
return(tmp1)
}
#Download Data
# install quantmod
#install.packages('quantmod')
library(quantmod)
getSymbols("XAU/USD", src="oanda")
getSymbols("XAG/USD", src="oanda")
getSymbols("XPT/USD", src="oanda")
getSymbols("XCU/USD", src="oanda")
getSymbols("EUR/USD",src="oanda")
getSymbols("INR/USD",src="oanda")
getSymbols("CNY/USD",src="oanda")
getSymbols("JPY/USD",src="oanda")
getSymbols("BRL/USD",src="oanda")
getSymbols("RUB/USD", src="oanda")
getSymbols("^GSPC", src = "yahoo")
gldnw=nrmw.com(XAUUSD,0)
slvnw=nrmw.com(XAGUSD,0)
pltnw=nrmw.com(XPTUSD,0)
eurnw=nrmw.com(EURUSD,0)
inrnw=nrmw.com(INRUSD,0)
cnynw=nrmw.com(CNYUSD,0)
brlnw=nrmw.com(BRLUSD,0)
rubnw=nrmw.com(RUBUSD,0)
spxnw=nrmw.stk(GSPC,length(gldnw))
leg=c("au","ag","pt","eur","inr","cny","brl","rub","sp500")
limy=c(0.45,1.1)
plot(gldnw,ylim=limy)
lines(slvnw,col=2)
lines(pltnw,col=3)
lines(eurnw,col=4)
lines(inrnw,col=5)
lines(cnynw,col=6)
lines(brlnw,col=7)
lines(rubnw,col=8)
lines(spxnw,col=9,lty=5,lwd=2)
legend("topleft",leg,text.col=c(1:9),horiz=TRUE)
library(changepoint)
install.packages('changepoint')
library(changepoint)
?cpt.mean
?cpt.meanvar
?cpt.var
t1=cpt.mean(gldnw,method='PELT',)
is.ts(gldnw)
as.ts(gldnw)
is.xts(gldnw)
index(gldnw)
chg.gld=cpt.mean(as.ts(gldnw,start=head(index(gldnw),1),end=tail(index(gldnw),1)),method='PELT')
plot(chg.gld)
chg.gld=cpt.var(as.ts(gldnw,start=head(index(gldnw),1),end=tail(index(gldnw),1)),method='PELT')
plot(chg.gld)
head(index(gldnw),1)
str(chg.gld)
chg.gld=cpt.meanvar(as.ts(gldnw,start=head(index(gldnw),1),end=tail(index(gldnw),1)),method='PELT')
plot(chg.gld)
start(gldnw)
chg.gld=cpt.meanvar(as.ts(gldnw,start=start(gldnw),end=end(gldnw),method='PELT')
)
end(gldnw)
chg.gld=cpt.meanvar(as.ts(gldnw,start=start(gldnw),end=end(gldnw),method='PELT'))
head(index(gldnw),1)
plot(chg.gld$cpt)
str(chg.gld)
chg.gld$cpts
chg.gld(class(cpts))
str(chg.gld)
chg.gld
head(chg.gld)
chg.gld(class='cpts')
chg.gld(class=cpts)
chg.gld[class=='cpts']
chg.gld[class='cpts']
chg.gld()
?subset
subset(chg.gld,cpts>0,select = cpts)
cpts(chg.gld)
subset(index(gldnw),index(gldnw)==cpts(chg.gld),select = index(gldnw))
subset(index(gldnw),index(gldnw)==cpts(chg.gld)
)
subset(index(gldnw),index(gldnw)=cpts(chg.gld))
subset(index(gldnw),index(gldnw)[cpts(chg.gld)])
(index(gldnw)[cpts(chg.gld)])
(index(gldnw)[cpts(chg.gld),na.rm=T])
(index(gldnw)[cpts(chg.gld)])
index(gldnw)[!is.na(cpts(chg.gld))]
?na.omit
!is.na(index(gldnw)[cpts(chg.gld)])
na.omit(index(gldnw)[cpts(chg.gld)])
plot(chg.gld)
#Norm funcs
nrmw.stk=function(x,y) {
tmp1=to.weekly(x)
names(tmp1)=c("op", "hi", "lo", "cl", "vo", "ad")
tmp2=last(tmp1,y)
tmp1=tmp2$cl/max(tmp2$hi)
return(tmp1)
}
nrmw.com=function(x,y){
tmp1=to.weekly(x)
names(tmp1)=c("op", "hi", "lo", "cl")
tmp2=last(tmp1,y)
tmp1=tmp2$cl/max(tmp2$hi)
return(tmp1)
}
#Download Data
# install quantmod
#install.packages('quantmod')
library(quantmod)
getSymbols("XAU/USD", src="oanda")
getSymbols("XAG/USD", src="oanda")
getSymbols("XPT/USD", src="oanda")
getSymbols("XCU/USD", src="oanda")
gldnw=nrmw.com(XAUUSD,0)
slvnw=nrmw.com(XAGUSD,0)
pltnw=nrmw.com(XPTUSD,0)
eurnw=nrmw.com(EURUSD,0)
inrnw=nrmw.com(INRUSD,0)
cnynw=nrmw.com(CNYUSD,0)
brlnw=nrmw.com(BRLUSD,0)
rubnw=nrmw.com(RUBUSD,0)
spxnw=nrmw.stk(GSPC,length(gldnw))
leg=c("au","ag","pt","eur","inr","cny","brl","rub","sp500")
limy=c(0.45,1.1)
plot(gldnw,ylim=limy)
lines(slvnw,col=2)
lines(pltnw,col=3)
lines(eurnw,col=4)
lines(inrnw,col=5)
lines(cnynw,col=6)
lines(brlnw,col=7)
lines(rubnw,col=8)
lines(spxnw,col=9,lty=5,lwd=2)
legend("topleft",leg,text.col=c(1:9),horiz=TRUE)
library(changepoint)
#Change point for gld using MeanVar and PELT
#need to fix the date formatting somehow
chg.gld=cpt.meanvar(as.ts(gldnw,start=head(index(gldnw),1),end=tail(index(gldnw),1)),method='PELT')
plot(chg.gld)
getSymbols("XAU/USD", src="oanda")
getSymbols("XAG/USD", src="oanda")
getSymbols("XPT/USD", src="oanda")
getSymbols("XCU/USD", src="oanda")
getSymbols("EUR/USD",src="oanda")
getSymbols("INR/USD",src="oanda")
getSymbols("CNY/USD",src="oanda")
getSymbols("JPY/USD",src="oanda")
getSymbols("BRL/USD",src="oanda")
getSymbols("RUB/USD", src="oanda")
getSymbols("^GSPC", src = "yahoo")
install.packages('tseries')
install.packages('PDQ')
getSymbols('DJIA',src='FRED')
str(DJIA)
getSymbols('GOLDPMGBD228NLBM',src='FRED')
str(GOLDPMGBD228NLBM)
getSymbols('ZMH')
getSymbols('ZMH',src='yahoo')
head(GOLDPMGBD228NLBM)
is.ts(GOLDPMGBD228NLBM)
is.xts(GOLDPMGBD228NLBM)
plot(GOLDPMGBD228NLBM)
plot(to.monthly(GOLDPMGBD228NLBM))
chg.gld=cpt.meanvar(as.ts(gldnw,start=head(index(gldnw),1),end=tail(index(gldnw),1)),method='PELT')
chg.gld2=cpt.meanvar(as.ts(to.monthly(GOLDPMGBD228NLBM),start=head(index(to.monthly(GOLDPMGBD228NLBM)),1),end=tail(index(to.monthly(GOLDPMGBD228NLBM)),1)),method='PELT')
plot(chg.gld2)
chg.gld2=cpt.var(as.ts(to.monthly(GOLDPMGBD228NLBM),start=head(index(to.monthly(GOLDPMGBD228NLBM)),1),end=tail(index(to.monthly(GOLDPMGBD228NLBM)),1)),method='PELT')
plot(chg.gld2)
plot(chg.gld)
cpts(chg.gld)
str(GSPC)
head(GSPC)
head(DJIA)
plot(DJIA)
head(EURUSD)
library(quantmod)
library(changepoint)
plot(DJIA)
to.quarterly(DJIA)
plot(to.quarterly(na.omit(DJIA)))
head(DJIA)
plot(to.quarterly(na.omit(DJIA)))
chg.gld=cpt.meanvar(as.ts(gldnw,start=head(index(gldnw),1),end=tail(index(gldnw),1)),method='PELT')
chg.gld=cpt.var(as.ts(gldnw,start=head(index(gldnw),1),end=tail(index(gldnw),1)),method='PELT')
plot(chg.gld)
chg.gld=cpt.mean(as.ts(gldnw,start=head(index(gldnw),1),end=tail(index(gldnw),1)),method='PELT')
plot(chg.gld)
chg.gld=cpt.meanvar(as.ts(gldnw,start=head(index(gldnw),1),end=tail(index(gldnw),1)),method='PELT')
plot(chg.gld)
?xts
?ts
head(gldnw)
head(as.ts(gldnw))
as.ts(gldnw,start=head(index(gldnw),1),end=tail(index(gldnw),1)
)
home(as.ts(gldnw,start=head(index(gldnw),1),end=tail(index(gldnw),1)))
head(as.ts(gldnw,start=head(index(gldnw),1),end=tail(index(gldnw),1)))
plot(as.ts(gldnw,start=head(index(gldnw),1),end=tail(index(gldnw),1)))
tail(index(gldnw),1)
?as.ts
plot(as.ts(gldnw,frequency=1,start=head(index(gldnw),1),end=tail(index(gldnw),1)))
plot(as.ts(gldnw,frequency=7,start=head(index(gldnw),1),end=tail(index(gldnw),1)))
plot(as.ts(gldnw,frequency=7,start=head(index(gldnw),1),end=tail(index(gldnw),1)))
head(as.ts(gldnw,frequency=7,start=head(index(gldnw),1),end=tail(index(gldnw),1)))
head(as.ts(gldnw,start=head(index(gldnw),1),end=tail(index(gldnw),1)))
index(as.ts(gldnw,start=head(index(gldnw),1),end=tail(index(gldnw),1)))
plot(diff(gldnw))
?diff
plot(diff(na.omit(gldnw)))
plot(diff(na.omit(gldnw),differences = 2))
plot(diff(na.omit(gldnw),differences = 4))
plot(diff(na.omit(gldnw),lag = 1))
plot(diff(na.omit(gldnw),lag = 4))
plot(diff(na.omit(gldnw),lag = 10))
?lag
?integrate
length(gldnw)
?as.ts
index(as.ts(gldnw,start=head(index(gldnw),1),end=tail(index(gldnw),1)))
index(as.ts(gldnw,start=head(index(gldnw),1),end=tail(index(gldnw),1),frequency=7))
index(as.ts(gldnw,start=head(index(gldnw),1),end=tail(index(gldnw),1),frequency=5))
index(as.ts(gldnw,start=head(index(gldnw),1),end=tail(index(gldnw),1),frequency=2))
index(as.ts(gldnw,start=head(index(gldnw),1),end=tail(index(gldnw),1),frequency=3))
index(as.ts(gldnw,start=head(index(gldnw),1),end=tail(index(gldnw),1),frequency=10))
index(as.ts(gldnw,start=head(index(gldnw),1),end=tail(index(gldnw),1),deltat=1/7))
index(as.ts(gldnw,start=head(index(gldnw),1),end=tail(index(gldnw),1),deltat='1/7'))
index(as.ts(gldnw,start=head(index(gldnw),1),end=tail(index(gldnw),1),deltat='1))
''
index(as.ts(gldnw,start=head(index(gldnw),1),end=tail(index(gldnw),1),deltat=1))
plot(chg.gld)
plot(chg.gld[1:length(gldnw)])
?cpts.ts
?cpts
cpts(chg.gld)
chg.gld=cpt.meanvar(as.ts(gldnw,start=head(index(gldnw),1),end=tail(index(gldnw),1)),method='PELT')
chg.gld=cpt.meanvar(head(as.ts(gldnw,start=head(index(gldnw),1),end=tail(index(gldnw),1)),method='PELT'),length(gldnw))
(head(as.ts(gldnw,start=head(index(gldnw),1),end=tail(index(gldnw),1)),method='PELT'),length(gldnw))
(head(as.ts(gldnw,start=head(index(gldnw),1),end=tail(index(gldnw),1)),method='PELT'),length(gldnw)))
(head(as.ts(gldnw,start=head(index(gldnw),1),end=tail(index(gldnw),1)),length(gldnw)))
chg.gld=cpt.meanvar(head(as.ts(gldnw,start=head(index(gldnw),1),end=tail(index(gldnw),1)),length(gldnw)),method='PELT')
plot(chg.gld)
cpts(chg.gld)
#extract dates from the index values
na.omit(index(gldnw)[cpts(chg.gld)])
library(ggplot2)
ggplot(data=gldnw,aes(x=index(gldnw),y=gldnw))
ggplot(data=gldnw,aes(x=index(gldnw),y=gldnw))+geom_line()
?splinefun
spline.gld=splinefun(gldnw,method = 'fmm')
spline.gld
plot(spline.gld)
spline.gld
spline.gld=splinefun(gldnw,method = 'natural')
plot(spline.gld)
spline.gld=splinefun(gldnw,method = 'periodic')
.5*2/3
smooth.spline(gldnw)
plot(smooth.spline(gldnw))
plot(smooth.spline(gldnw),type = l)
plot(smooth.spline(gldnw),type = 2)
plot(smooth.spline(gldnw),type = 'l')
plot(smooth.spline(gldnw),type = 'p')
plot(smooth.spline(gldnw),type = 'pl')
plot(smooth.spline(gldnw),type = 'lp')
plot(smooth.spline(gldnw),type = 'h')
plot(smooth.spline(gldnw),type = 's')
plot(smooth.spline(gldnw),type = 'c')
plot(smooth.spline(gldnw),type = 'z')
plot(smooth.spline(gldnw),type = 'a')
plot(smooth.spline(gldnw),type = 's')
lib\(quantmod)
library(quantmod)
head(GOLDPMGBD228NLBM)
chg.gld=cpt.meanvar(head(as.ts(gldnw,start=head(index(gldnw),1),end=tail(index(gldnw),1)),length(gldnw)),method='PELT')
plot(chg.gld)
library(changepoint)
chg.gld=cpt.meanvar(head(as.ts(gldnw,start=head(index(gldnw),1),end=tail(index(gldnw),1)),length(gldnw)),method='PELT')
plot(chg.gld)
chg.gld2=cpt.meanvar(head(as.ts(GOLDPMGBD228NLBM,start=head(index(GOLDPMGBD228NLBM),1),end=tail(index(GOLDPMGBD228NLBM),1)),length(GOLDPMGBD228NLBM)),method='PELT')
plot(chg.gld2)
as.ts(GOLDPMGBD228NLBM,start=head(index(GOLDPMGBD228NLBM),1),end=tail(index(GOLDPMGBD228NLBM),1))
na.omit(as.ts(GOLDPMGBD228NLBM,start=head(index(GOLDPMGBD228NLBM),1),end=tail(index(GOLDPMGBD228NLBM),1)))
na.omit(as.ts(GOLDPMGBD228NLBM,start=head(index(GOLDPMGBD228NLBM),1),end=tail(index(GOLDPMGBD228NLBM),1))))
as.ts(GOLDPMGBD228NLBM,start=head(index(GOLDPMGBD228NLBM),1),end=tail(index(GOLDPMGBD228NLBM),1))
na.exclude(as.ts(GOLDPMGBD228NLBM,start=head(index(GOLDPMGBD228NLBM),1),end=tail(index(GOLDPMGBD228NLBM),1)))
head(na.exclude(as.ts(GOLDPMGBD228NLBM,start=head(index(GOLDPMGBD228NLBM),1),end=tail(index(GOLDPMGBD228NLBM),1))),length(GOLDPMGBD228NLBM))
cpt.meanvar(head(na.exclude(as.ts(GOLDPMGBD228NLBM,start=head(index(GOLDPMGBD228NLBM),1),end=tail(index(GOLDPMGBD228NLBM),1))),length(GOLDPMGBD228NLBM)),method='PELT)'
cpt.meanvar(head(na.exclude(as.ts(GOLDPMGBD228NLBM,start=head(index(GOLDPMGBD228NLBM),1),end=tail(index(GOLDPMGBD228NLBM),1))),length(GOLDPMGBD228NLBM)),method='PELT')
chg.gld2=cpt.meanvar(head(na.exclude(as.ts(GOLDPMGBD228NLBM,start=head(index(GOLDPMGBD228NLBM),1),end=tail(index(GOLDPMGBD228NLBM),1))),length(GOLDPMGBD228NLBM)),method='PELT')
plot(chg.gld2)
chg.gld2=cpt.meanvar(head(
na.exclude(as.ts(
to.monthly(GOLDPMGBD228NLBM),
start=head(index(to.monthly(GOLDPMGBD228NLBM)),1),
end=tail(index(to.monthly(GOLDPMGBD228NLBM)),1))),
length(to.monthly(GOLDPMGBD228NLBM))),method='PELT')
plot(chg.gld2)
chg.gld2=cpt.meanvar(head(
na.exclude(as.ts(
to.monthly(GOLDPMGBD228NLBM),
start=head(index(to.monthly(GOLDPMGBD228NLBM)),1),
end=tail(index(to.monthly(GOLDPMGBD228NLBM)),1))),
length(na.exclude(to.monthly(GOLDPMGBD228NLBM)))),
method='PELT')
chg.gld2=cpt.meanvar(head(
na.exclude(as.ts(
to.yearly(GOLDPMGBD228NLBM),
start=head(index(to.yearly(GOLDPMGBD228NLBM)),1),
end=tail(index(to.yearly(GOLDPMGBD228NLBM)),1))),
length(na.exclude(to.yearly(GOLDPMGBD228NLBM)))),
method='PELT')
cpts(chg.gld2)
?cpt.var
chg.gld2=cpt.meanvar(head(
na.exclude(as.ts(
to.yearly(GOLDPMGBD228NLBM),
start=head(index(to.yearly(GOLDPMGBD228NLBM)),1),
end=tail(index(to.yearly(GOLDPMGBD228NLBM)),1))),
length(na.exclude(to.yearly(GOLDPMGBD228NLBM)))),
method='SegNeigh')
?Delt
head(DJIA)
head(Delt(DJIA))
head(Delt(DJIA,1))
head(Delt(DJIA,k=1))
head(Delt(DJIA,k=2))
head(Delt(DJIA,k=0))
head(GSPC)
ret.spy=Delt(Op(x = GSPC),Cl(x = GSPC))
sgnl.spy=lag(ifelse(Cl(GSPC)>Op(GSPC),1,0),1)
strat.perf=ret.spy*sgnl.spy
head(strat.perf)
plot(strat.perf)
library(quantmod)
#Create a retuns vector based on opaning cna closing prices
ret.spy=Delt(Op(x = GSPC),Cl(x = GSPC))
# Signal Vector based on the prce changes increase => 1 else 0 and lag it by one period
sgnl.spy=lag(ifelse(Cl(GSPC)>Op(GSPC),1,0),1)
#performance matrix by multiplying returns to signal
strat.perf=ret.spy*sgnl.spy
?SMI
